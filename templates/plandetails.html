{% extends 'index.html' %}

{% block title %}My Plan{% endblock %}

{% block content %}

<h2>‚ú®Plan id#{{ plan.plan_id }}‚ú®</h2>

<h3>
    <!-- TODO: make this a textarea so user can customize their own description for plan -->
    Overview: {{ plan.overview }} 
    <span class="edit-plan-overview">
        <input type="button" value="edit" name="btnEditOverview"/>
    </span>
    <div id="dvEditOverview" class="hide">
        <form action="/plan/{{ plan.plan_id }}/overview" method="POST">
            <input type="textarea" name="txtEditOverview" re>
            <input type="submit" value="+">
        </form>
    </div>
</h3>

<p>- Location: {{ location[0] }}, {{ location[1] }}</p>
<p>- Event details:
    <ol id="event-list">
        {% for event in events %}
            <li>
                {{ event.overview }} üìÖ [{{ event.datetime.strftime('%d, %b %Y') }}]
            </li>
        {% endfor %}
    </ol>

</p>

<!-- TO BE IMPLEMENTED -->
<!-- <form action="/plan/{{ plan.plan_id }}" method="POST">
    <input type="text" id="event-item">
    <button id="event-adder">Custom event</button> 
</form> -->
<!-- MVP FEATURE -->
<form action="/plan/{{ plan.plan_id }}" method="POST">
    <select name="dropdown-event" id="dropdown-event">
        {% for item in db_events %}
            {% if item not in events %} <!--checks only for events not already on plan list-->
                {% if plan.location_id == item.location_id %}
                    <option value="{{ item.event_id }}">{{ item.overview }}</option>
                {% endif %}
            {% endif %}  
            {% if not item %}
                0 events found in current city.
            {% endif %}
        {% endfor %}
        
    </select>
    <button id="dropdown-event-adder">Add event</button> 
</form>

<br>

<!-- Delete Plan Button -->
<div>
    <form action="/plan/{{ plan.plan_id }}/delete" method="POST">
        <input class="makered" type="submit" value="Delete Plan">
    </form>
</div>

<hr class="div-line">


<!-- Home/Back Buttons -->
<div>
    <a href="/">
        <button>Homeüè†</button>
    </a>
    <br>
    <a href="/user/{{ plan.user_id }}">
        <button>Go back!</button>
    </a>
</div>
    

{% endblock %}